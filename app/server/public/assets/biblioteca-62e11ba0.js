import{b as h,h as c,c as y,l as P,g as x,s as g}from"./init-35cba5cd.js";import{l as v,_ as w}from"./viewpartials-7a86f681.js";async function m(t,a,n=1,o,s){try{const e={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(h+`/api/busquedaLibros?programaid=${n}&page=${t}&iestpid=${o}&textobusqueda=${a}&tipolibroid=${s}`,e)).json()}catch(r){console.log("error",r)}}async function k(){try{const a={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(h+"/api/obtenertipoLibro",a)).json()}catch(t){console.log("error",t)}}c();(async function(){let t=[{path:"partials/shared/header.html",container:"app-header"},{path:"partials/shared/menu.html",container:"app-side"}];try{await v(t),w(()=>import("./common-8d3221b9.js"),[]),console.log("Las vistas parciales se han cargado correctamente!"),q()}catch(a){console.error(a)}})();function q(){L(),y(),H(),p(),D(),P(),_()}async function L(){$("#txt-textobusqueda").on("keydown",function(a){a.keyCode==13&&p()}),$("#drptipolibro").empty();let t=await k();for(let a of t)$("#drptipolibro").append(`<option value="${a.id}">${a.tipolibro}</option>`)}function _(){$("#btnlimpiarbusqueda").on("click",function(t){$("#txt-textobusqueda").val("")})}function H(){let t=x("session").usuario;$("#drpprogramaid").empty(),t.rolid!=3&&$("#drpprogramaid").append('<option value="0">-TODOS-</option>');for(let a of t.programas)$("#drpprogramaid").append(`<option value="${a.id}">${a.denominacion}</option>`)}let d=1;async function p(){g(),$("#pagination-demo").empty(),$("#pagination-demo").removeData("twbs-pagination"),$("#pagination-demo").unbind("page");let t=x("usuario"),a,n=1,o=$("#txt-textobusqueda").val(),s=$("#drpprogramaid option:selected").val(),r=t.iestpid;d=$("#drptipolibro option:selected").val()||1;let e=await m(n,o,s,r,d);a=e.totalPages,e.currentPage*10>e.total?$("#txtcant-mostrar").text((e.currentPage-1)*10+(10-(e.currentPage*10-e.total))):$("#txtcant-mostrar").text(e.currentPage*10),$("#txtcant-total").text(e.total),f(e.data),c(),$("#pagination-demo").twbsPagination({totalPages:a,visiblePages:4,onPageClick:async function(u,l){g();let i=await m(l,o,s,r,d);$("#txtcant-total").text(i.total),(i.currentPage+1)*10>i.total?$("#txtcant-mostrar").text((i.currentPage-1)*10+(10-(i.currentPage*10-i.total))):$("#txtcant-mostrar").text(i.currentPage*10),f(i.data),b(),c()}}),b()}function b(){$("#pagination-demo .prev a").text("Anterior"),$("#pagination-demo .next a").text("Siguiente"),$("#pagination-demo .first a").text("Primero"),$("#pagination-demo .last a").text("Último")}async function f(t){$("#resultadobooks").empty();for(let a of t)$("#resultadobooks").append(T(a));$('[data-toggle="tooltip"]').tooltip()}function T({id:t,url_portada:a,titulo:n,valor:o,autores:s}){let r="",e=o==null||o=="null"?0:parseInt(o);for(let l=1;l<=5;l++)l<=e?r+="<span>&#9733;</span>":r+="<span>&#9734;</span>";return`
    <div class="col-12 col-md-2-5">
    <div class="card card-book" style="width: 14rem;">
    <a href="detailbook.html?id=${t}"> <img class="card-img-top" height="195" src="${a}" alt="Card image cap">
    </a>    
    <div class="card-body">
        <a href="detailbook.html?id=${t}">
          <h5 data-toggle="tooltip" title="${n}" class="card-title long-text" >${n}</h5></a>
          <p class="card-text">${s}</p>
          <div class="rating">
            ${r}
          </div>
        </div>
      </div>
</div>
`}function D(){$("#btnbuscarlibro").on("click",function(t){$("#btnbuscarlibro").prop("disabled",!0).text("Buscando..."),p(),$("#btnbuscarlibro").prop("disabled",!1).text("Búscar")})}
