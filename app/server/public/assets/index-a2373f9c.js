import{b as s,h as n,a as r}from"./init-35cba5cd.js";import{v as i}from"./validateForm-1578b31b.js";import{o as c}from"./path-6610c907.js";async function l(e,t){const o={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({usuario:e,clave:t})};try{return await(await fetch(s+"/api/login",o)).json()}catch(a){console.error("Error:",a)}}async function u(e){const t={method:"GET",headers:{}};try{return await(await fetch(s+"/api/iestp?nombre="+e,t)).json()}catch(o){console.error("Error:",o)}}n();p();let{iestp:m}=c();d(m);async function d(e){let t=await u(e);t&&$("#logoiestp").attr("src",t.logourl)}$("#btnlogin").on("click",function(e){i("form",function(){g($("#txtusuario").val(),$("#txtclave").val())})});async function g(e,t){$("#btnlogin").prop("disabled",!0).text("Logueado...");let o=await l(e,t);console.log(o),o.islogueado?(r("usuario",o.usuario),r("accessToken",o.token),window.location.href="inicio.html"):($("#error_msj").show(),setTimeout(()=>{$("#error_msj").hide()},4e3)),$("#btnlogin").prop("disabled",!1).text("Login")}function p(){localStorage.removeItem("session"),localStorage.removeItem("usuario"),localStorage.removeItem("accessToken")}
