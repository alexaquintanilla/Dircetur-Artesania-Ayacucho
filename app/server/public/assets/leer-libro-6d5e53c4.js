import{b as i,h as u,c as d,l as m,g as a}from"./init-35cba5cd.js";import{l as p,_ as f}from"./viewpartials-7a86f681.js";import{o as c}from"./path-6610c907.js";async function b(r){try{const o={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(i+"/api/libro?id="+r,o)).json()}catch(e){console.log("error",e)}}async function g({libroid:r,tokenuser:e}){try{const t={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(`${i}/api/mostrarLibro?libroid=${r}&token=${e}`,t)).json()}catch(o){console.log("error",o)}}(async function(){let r=[{path:"partials/shared/header.html",container:"app-header"},{path:"partials/shared/menu.html",container:"app-side"}];try{await p(r),f(()=>import("./common-8d3221b9.js"),[]),console.log("Las vistas parciales se han cargado correctamente!"),h()}catch(e){console.error(e)}})();function h(){u(),d(),v(),k(),m(),y(),F()}function w(r){const e=/\/uc\?id=([^&]+)/,o=r.match(e);return o&&o[1]?o[1]:null}async function v(){let{libroid:r,titulo:e}=c();if($("#txt-titulo").text(e),a("accessToken").split(" ")[1],!r)return;let o=await b(r),t=w(o.url_digital);t&&$("#visorLibro").attr("src",`https://drive.google.com/file/d/${t}/preview`),console.log(o)}function k(){$("#btnDescargarlibro").on("click",function(r){$("#btnDescargarlibro").prop("disabled",!0).text("Descargando...");let{libroid:e,titulo:o}=c(),t=a("accessToken").split(" ")[1];r.preventDefault();let l=$("#pagina-inicio").val(),n=$("#pagina-fin").val();var s=document.createElement("a");s.setAttribute("download",o+".pdf"),s.setAttribute("target","_blank"),s.setAttribute("href",`${i}/api/mostrarLibroparte?pagini=${l}&pagfin=${n}&libroid=${e}&token=${t}`),document.body.appendChild(s),s.click(),document.body.removeChild(s),$("#btnDescargarlibro").prop("disabled",!1).text("Descargar")})}function y(){$("#profile-tab").on("click",async function(r){if(r.preventDefault(),$("#visorLibro2").attr("src")==""){let{libroid:e,titulo:o}=c(),t=a("accessToken").split(" ")[1],l=await g({libroid:e,tokenuser:t});console.log(l);let n=window.location.port,s=window.location.protocol+"//"+window.location.hostname;n!="80"&&(s+=":"+n),s+="/visorPDF/web/viewer.html?file=",l.valid&&$("#visorLibro2").attr("src",s+i+"/books/"+l.path)}})}function F(){const r=document.getElementById("toggleButton1"),e=document.getElementById("myTabContent");r.addEventListener("click",()=>{e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()});const o=document.getElementById("toggleButton2"),t=document.getElementById("profile");o.addEventListener("click",()=>{t.requestFullscreen?e.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()})}
