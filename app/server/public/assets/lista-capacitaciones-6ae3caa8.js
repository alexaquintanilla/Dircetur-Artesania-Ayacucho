import"./modulepreload-polyfill-3cfb730f.js";import{l as C,_ as E}from"./viewpartials-7a86f681.js";import{b as w}from"./config-ef5f6dbc.js";import{h as _,s as M}from"./init-52a8aa54.js";import{s}from"./toast-8abe4fe9.js";async function g(o){const t={method:"GET",redirect:"follow"};try{return await(await fetch(w+`/api/search?search=${encodeURIComponent(o)}`,t)).json()}catch(a){throw console.error("Error al buscar los certificados:",a),a}}async function b(o){try{const a={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(w+"/api/nota/"+o,a)).json()}catch(t){console.log("error",t)}}async function L(o){const t={method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(o)};try{return await(await fetch(w+"/api/nota",t)).json()}catch(a){console.error("Error:",a)}}async function T(o){o.programaid==0&&(o.programaid=null);const t={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(o)};try{return await(await fetch(w+"/api/nota_save",t)).json()}catch(a){console.error("Error:",a)}}async function j(o){o.programaid==0&&(o.programaid=null);const t={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(o)};try{return await(await fetch(w+"/api/nota",t)).json()}catch(a){console.error("Error:",a)}}_();(async function(){let o=[{path:"partials/shared/header.html",container:"app-header"},{path:"partials/shared/menuadmin.html",container:"app-side"}];try{await C(o),E(()=>import("./common-8d3221b9.js"),[]),console.log("Las vistas parciales se han cargado correctamente!"),B()}catch(t){console.error(t)}})();function B(){S(),H(),N()}async function H(){$("#btnDescargar").on("click",async function(o){P(c,"Consolidado-Certificados")})}async function N(){$("#btnNuevoRegistro").on("click",async function(o){U(0),$("#txt-dni1").val(""),$("#txt-nombres1").val(""),$("#txt-cod_curso1").val(""),$("#txt-nota1").val(""),$("#txt-cant_horas1").val(""),$("#txt-fecha_inicio1").val(""),$("#txt-fecha_fin1").val(""),$("#txt-fecha_emision1").val(""),$("#txt-instructor1").val(""),$("#txt-temario1").val(""),$("#txt-curso1").val(""),$("#txt-ubicacion1").val(""),$("#txt-institucion_solicitante1").val("")})}var c=null,k=null;async function S(){$("#btnbuscar").on("click",async function(t){if(t.preventDefault(),$("#searchBox").val()){M(),c=await g($("#searchBox").val());let r=document.getElementById("tablaCertificados");r.innerHTML="";let e='<tr><th>N°</th><th>Nombres Completos</th><th>Curso</th><th>Fecha Emisión</th><th>Código</th> <th colspan="3" style="text-align: center;">Certificado</th></tr>';r.innerHTML+=e;let n=1;for(let l of c){let i="<tr>";i+=`<td>${n}</td>`,i+=`<td>${l.nombres}</td>`,i+=`<td>${l.curso}</td>`,i+=`<td>${l.fecha_fin}</td>`,i+=`<td>${l.cod_curso}</td>`,i+=`<td><a href="javascript:void(0);"   class="open-modal" data-toggle="tooltip" title="Editar" data-id="${l.id}" style="color: blue; text-decoration: underline;"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px;">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg></a></td>`,i+=`<td><a href="javascript:void(0);" class="btn_Eliminar" data-toggle="tooltip" title="Eliminar" data-id="${l.id}" style="color: blue; text-decoration: underline;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px;">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <line x1="9" y1="9" x2="15" y2="15"/>
            <line x1="15" y1="9" x2="9" y2="15"/>
          </svg></a></td>`,i+=`<td><a href="${l.certificado}" target="_blank" data-toggle="tooltip" title="Ver certificado" style="color: blue; text-decoration: underline;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px;">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg></a></td>`,i+="</tr>",r.innerHTML+=i,n++}$('[data-toggle="tooltip"]').tooltip(),_()}else s("Ingrese código de certificado o el Nombre del estudiante")});async function o(){c=await g($("#searchBox").val());let t=document.getElementById("tablaCertificados");t.innerHTML="";let a='<tr><th>N°</th><th>Nombres Completos</th><th>Curso</th><th>Fecha Emisión</th><th>Código</th> <th colspan="3" style="text-align: center;">Certificado</th></tr>';t.innerHTML+=a;let r=1;for(let e of c){let n="<tr>";n+=`<td>${r}</td>`,n+=`<td>${e.nombres}</td>`,n+=`<td>${e.curso}</td>`,n+=`<td>${e.fecha_fin}</td>`,n+=`<td>${e.cod_curso}</td>`,n+=`<td><a href="javascript:void(0);"   class="open-modal" data-toggle="tooltip" title="Editar" data-id="${e.id}" style="color: blue; text-decoration: underline;"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px;">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg></a></td>`,n+=`<td><a href="javascript:void(0);" class="btn_Eliminar" data-toggle="tooltip" title="Eliminar" data-id="${e.id}" style="color: blue; text-decoration: underline;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px;">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <line x1="9" y1="9" x2="15" y2="15"/>
            <line x1="15" y1="9" x2="9" y2="15"/>
          </svg></a></td>`,n+=`<td><a href="${e.certificado}" target="_blank" data-toggle="tooltip" title="Ver certificado" style="color: blue; text-decoration: underline;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px;">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg></a></td>`,n+="</tr>",t.innerHTML+=n,r++}$('[data-toggle="tooltip"]').tooltip()}$("#btnactualizar").on("click",async function(t){t.preventDefault();var a=!0;if($("#form .form-control[required]").each(function(){$(this).val()===""?(a=!1,$(this).css("border-color","red")):$(this).css("border-color","")}),!a)alert("Por favor, completa todos los campos requeridos.");else{let r=$("#txt-dni").val(),e=$("#txt-nombres").val(),n=$("#txt-cod_curso").val(),l=$("#txt-nota").val(),i=$("#txt-cant_horas").val(),d=$("#txt-fecha_inicio").val(),u=$("#txt-fecha_fin").val(),h=$("#txt-fecha_emision").val(),v=$("#txt-instructor").val(),f=$("#txt-temario").val(),p=$("#txt-curso").val(),x=$("#txt-ubicacion").val(),m=$("#txt-institucion_solicitante").val();await T({fecha_emision:h,id:k,dni:r,nombres:e,cod_curso:n,curso:p,nota:l,cant_horas:i,fecha_inicio:d,fecha_fin:u,instructor:v,temario:f,ubicacion:x,institucion_solicitante:m})?(s("Se actualizo los datos correctamente"),o(),$("#myModal").css("display","none")):s("Ocurrio un error.")}}),$("#btnuevo").on("click",async function(t){t.preventDefault();var a=!0;if($("#form2 .form-control[required]").each(function(){$(this).val()===""?(a=!1,$(this).css("border-color","red")):$(this).css("border-color","")}),!a)alert("Por favor, completa todos los campos requeridos.");else{let r=$("#txt-dni1").val(),e=$("#txt-nombres1").val(),n=$("#txt-cod_curso1").val(),l=$("#txt-nota1").val(),i=$("#txt-cant_horas1").val(),d=$("#txt-fecha_inicio1").val(),u=$("#txt-fecha_fin1").val(),h=$("#txt-fecha_emision1").val(),v=$("#txt-instructor1").val(),f=$("#txt-temario1").val(),p=$("#txt-curso1").val(),x=$("#txt-ubicacion1").val(),m=$("#txt-institucion_solicitante1").val();await j({fecha_emision:h,dni:r,nombres:e,cod_curso:n,curso:p,nota:l,cant_horas:i,fecha_inicio:d,fecha_fin:u,instructor:v,temario:f,ubicacion:x,institucion_solicitante:m})?(s("Se registro los datos correctamente"),o(),$("#myModalNuevo").css("display","none")):s("Ocurrio un error.")}})}$(document).on("click",".btn_Eliminar",async function(o){async function t(){c=await g($("#searchBox").val());let r=document.getElementById("tablaCertificados");r.innerHTML="";let e='<tr><th>N°</th><th>Nombres Completos</th><th>Curso</th><th>Fecha Emisión</th><th>Código</th> <th colspan="3" style="text-align: center;">Certificado</th></tr>';r.innerHTML+=e;let n=1;for(let l of c){let i="<tr>";i+=`<td>${n}</td>`,i+=`<td>${l.nombres}</td>`,i+=`<td>${l.curso}</td>`,i+=`<td>${l.fecha_fin}</td>`,i+=`<td>${l.cod_curso}</td>`,i+=`<td><a href="javascript:void(0);"   class="open-modal" data-toggle="tooltip" title="Editar" data-id="${l.id}" style="color: blue; text-decoration: underline;"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px;">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg></a></td>`,i+=`<td><a href="javascript:void(0);" class="btn_Eliminar" data-toggle="tooltip" title="Eliminar" data-id="${l.id}" style="color: blue; text-decoration: underline;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px;">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <line x1="9" y1="9" x2="15" y2="15"/>
            <line x1="15" y1="9" x2="9" y2="15"/>
          </svg></a></td>`,i+=`<td><a href="${l.certificado}" target="_blank" data-toggle="tooltip" title="Ver certificado" style="color: blue; text-decoration: underline;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px;">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg></a></td>`,i+="</tr>",r.innerHTML+=i,n++}$('[data-toggle="tooltip"]').tooltip()}o.preventDefault();var a=confirm("¿Estás seguro de que deseas eliminar?");if(a){let r=$(this).data("id"),e=await b(r),n=e.dni,l=e.nombres,i=e.cod_curso,d=e.nota,u=e.cant_horas,h=e.fecha_inicio,v=e.fecha_fin,f=e.instructor,p=e.temario,x=e.curso,m=e.ubicacion,y=e.institucion_solicitante;await L({id:r,dni:n,nombres:l,cod_curso:i,curso:x,nota:d,cant_horas:u,fecha_inicio:h,fecha_fin:v,instructor:f,temario:p,ubicacion:m,institucion_solicitante:y})?(s("Se elimino los datos correctamente"),await t()):s("Ocurrio un error.")}else console.log("El usuario canceló la acción.")});$(document).on("click",".open-modal",async function(){var o=$(this).data("id");k=$(this).data("id"),O(o);let t=await b(o);t?($("#txt-dni").val(t.dni),$("#txt-nombres").val(t.nombres),$("#txt-cod_curso").val(t.cod_curso),$("#txt-nota").val(t.nota),$("#txt-cant_horas").val(t.cant_horas),$("#txt-fecha_inicio").val(t.fecha_inicio),$("#txt-fecha_fin").val(t.fecha_fin),$("#txt-fecha_emision").val(t.fecha_emision),$("#txt-instructor").val(t.instructor),$("#txt-temario").val(t.temario),$("#txt-curso").val(t.curso),$("#txt-ubicacion").val(t.ubicacion),$("#txt-institucion_solicitante").val(t.institucion_solicitante)):($("#txt-dni").val(""),$("#txt-nombres").val(""),$("#txt-cod_curso").val(""),$("#txt-nota").val(""),$("#txt-cant_horas").val(""),$("#txt-fecha_inicio").val(""),$("#txt-fecha_fin").val(""),$("#txt-instructor").val(""),$("#txt-temario").val(""),$("#txt-curso").val(""),$("#txt-ubicacion").val(""),$("#txt-institucion_solicitante").val(""))});function O(o){console.log("Abrir modal para el ID:",o),$("#myModal").find(".modal-content p"),$("#myModal").css("display","block"),$("#closeButton").click(function(){$("#myModal").css("display","none")}),$(window).click(function(t){t.target.id=="myModal"&&$("#myModal").css("display","none")})}function U(o){console.log("Abrir modal para el ID:",o),$("#myModalNuevo").find(".modal-content p"),$("#myModalNuevo").css("display","block"),$("#closeButtonNuevo").click(function(){$("#myModalNuevo").css("display","none")}),$(window).click(function(t){t.target.id=="myModalNuevo"&&$("#myModalNuevo").css("display","none")})}function P(o,t){var a=alasql(`SELECT *
  FROM ? `,[o]),r=[{sheetid:"Reporte",headers:!0}];alasql(`SELECT INTO XLSX("${t}.xlsx",?) FROM ?`,[r,[a]])}
