import"./modulepreload-polyfill-3cfb730f.js";import{v as i}from"./validateForm-1578b31b.js";import{b as l,s as n}from"./config-64035b4f.js";import{h as c}from"./init-bc9bbeea.js";function u(){const a=window.location.href,r=new URL(a).searchParams,e={};for(const[o,s]of r.entries())e.hasOwnProperty(o)?(Array.isArray(e[o])||(e[o]=[e[o]]),e[o].push(s)):e[o]=s;return e}async function m(a,t){const r={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({usuario:a,clave:t})};try{const o=await(await fetch(l+"/login",r)).json();return console.log("Token:",o.token),o&&o.token&&(n("accessToken",o.token),n("rol",o.usuario.rolid)),o}catch(e){console.error("Error:",e)}}c();d();u();$("#btnlogin").on("click",function(a){i("form",function(){f($("#txtusuario").val(),$("#txtclave").val())})});async function f(a,t){$("#btnlogin").prop("disabled",!0).text("Logueado...");let r=await m(a,t);console.log(r),r.islogueado?(n("usuario",r.usuario),n("accessToken",r.token),window.location.href=r.usuario.url):($("#error_msj").show(),setTimeout(()=>{$("#error_msj").hide()},4e3)),$("#btnlogin").prop("disabled",!1).text("Login")}function d(){localStorage.removeItem("session"),localStorage.removeItem("usuario"),localStorage.removeItem("accessToken")}
