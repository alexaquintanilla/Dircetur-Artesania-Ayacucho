import"./modulepreload-polyfill-3cfb730f.js";import{l as Be,_ as Le}from"./viewpartials-7a86f681.js";import{F as ke}from"./uploadJorge-fc196769.js";import{b as y,a as Y}from"./config-ef5f6dbc.js";import{h as W,l as Fe,s as ce}from"./init-52a8aa54.js";import{s as p}from"./toast-8abe4fe9.js";/* empty css              */import{A as De}from"./alert-3bd678b2.js";async function je(o){try{const n=new URLSearchParams(o);return await(await fetch(y+`/productos?${n}`)).json()}catch(n){console.error("Error al buscar las producto:",n)}}async function qe(o){o.productId!=0&&(o.id=o.productId);const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)};try{return await(await fetch(y+"/producto/save",n)).json()}catch(s){console.error("Error:",s)}}async function Je(o){try{const s={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(y+"/producto/"+o,s)).json()}catch(n){console.log("error",n)}}async function Ae(){try{const n={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(y+"/categoria",n)).json()}catch(o){console.log("error",o)}}async function ze(o){try{const s={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(y+"/artesano-dni/"+o,s)).json()}catch(n){console.log("error",n)}}async function He(o){try{const s={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(y+"/artesano/"+o,s)).json()}catch(n){console.log("error",n)}}const _=new De;W();(async function(){let o=[{path:"partials/shared/header.html",container:"app-header"},{path:"partials/shared/menu.html",container:"app-side"}];try{await Be(o),Le(()=>import("./common-8d3221b9.js"),[]),console.log("Las vistas parciales se han cargado correctamente!"),Me()}catch(n){console.error(n)}})();function Me(){setTimeout(function(){Fe(),Re()},500)}var pe=null,i=null,O=0;let w=0,R=0,V=0,J=0,A=0,z=0,H=0;var ee=0;async function Re(){$("#filtrar-producto").on("click",async function(r){r.preventDefault(),ce();const v=document.getElementById("nombre-producto").value,b=document.getElementById("nombre-artesano").value,h=document.getElementById("precios-id").value,E=document.getElementById("cantidades-id").value;pe=await je({nombres_es:v,nombre_completo:b,precio:h,cantidad:E});let g=document.getElementById("tablaproducto");g.innerHTML="";let P='<tr><th>N°</th><th>Imagen</th><th>Producto</th><th>Nombre Artesano</th><th>Precio S/.</th><th>Stock</th> <th  style="text-align: center;">Acciones</th></tr>';g.innerHTML+=P;let N=1;for(let e of pe){let t="<tr>";t+=`<td>${N}</td>`,t+=`<td style="text-align: center;"><img src="${e.imagen_principal}" alt="Imagen" style="width: 150px;ali height: auto;"></td>`,t+=`<td>${e.nombres_es}</td>`,t+=`<td>${e.nombre_completo}</td>`,t+=`<td>${e.precio}</td>`,t+=`<td>${e.cantidad}</td>`,t+=`<td style="text-align: center;"><a href="/productos-detalle.html?id=${e.id}" data-toggle="tooltip" title="Editar" data-id="${e.id}" class="btn btn-info btn-sm" > <i class="icon icon-edit2"></i></a> `,t+=`<a href="javascript:void(0);"  data-toggle="tooltip" title="Eliminar" data-id="${e.id}" class="btn btn-primary btn-sm">  <i class="icon icon-bin"></i></a>`,t+="</td>",t+="</tr>",g.innerHTML+=t,N++}$('[data-toggle="tooltip"]').tooltip(),W()});function o(r){return/^\d+$/.test(r)}function n(r){return/^\d+(\.\d+)?$/.test(r)}$("#btnguardarcambio").on("click",async function(r){r.preventDefault();var v=!0;if($("#form .form-control[required]").each(function(){$(this).val()===""||$(this).val()==="0"?(v=!1,$(this).css("border-color","red")):$(this).css("border-color","")}),v){let E=$("#idespanolNombre").val(),I=$("#idinglesNombre").val(),g=$("#idespanolResumen").val(),P=$("#idinglesResumen").val(),N=$("#idespanolDescripcion").val(),e=$("#idinglesDescripcion").val(),t=$("#idespanolCualidades").val(),l=$("#idinglesCualidades").val(),u=$("#idespanolPalabras").val(),a=$("#idinglesPalabras").val(),x=$("#idespanolPiezas").val(),S=$("#idinglesPiezas").val(),d=$("#idalto").val(),m=$("#idancho").val(),ge=$("#idespanolMateriales").val(),he=$("#idinglesMateriales").val(),C=$("#precioproducto").val(),T=$("#pesokilogramos").val(),$e=$("#idespanolTecnicas").val(),ye=$("#idinglesTecnicas").val(),B=$("#cantidad").val(),L=$("#cantidadMinima").val(),Ee=$("#restarStock").is(":checked")?1:0,Z=$("#estadoAgotado").val(),M=$("#fechaDisponible").val(),K=$("#lstcategoria").val();d=d===""?0:n(d)?parseFloat(d):NaN,m=m===""?0:n(m)?parseFloat(m):NaN,C=C===""?0:n(C)?parseFloat(C):NaN,T=T===""?0:n(T)?parseFloat(T):NaN,B=B===""?0:o(B)?parseInt(B,10):NaN,L=L===""?0:o(L)?parseInt(L,10):NaN,M=M===""?null:M,Z=parseInt(Z,10),K=parseInt(K,10);let Ie=$("#impuestoIGV").is(":checked")?1:0,we=$("#precioEnvio").is(":checked")?1:0,k=$("#envioLocal").val(),F=$("#envioNacional").val(),D=$("#envioExtranjero").val(),j=$("#tiemposElaboracion").val(),q=$("#tiemposEnvio").val(),Ne=$("#preventas").is(":checked")?1:0;k=k===""?0:n(k)?parseFloat(k):NaN,F=F===""?0:n(F)?parseFloat(F):NaN,D=D===""?0:n(D)?parseFloat(D):NaN,j=j===""?0:o(j)?parseInt(j,10):NaN,q=q===""?0:o(q)?parseInt(q,10):NaN;let ae=[];$("#listaCostos tr").each(function(){let c=$(this),f={id:c.find("td").eq(0).text(),nombre:c.find("td").eq(1).text(),precio:c.find("td").eq(2).text()};ae.push(f)});let xe=JSON.stringify(ae),ne=[];$("#listaOfertas tr").each(function(){let c=$(this),f={id:c.find("td").eq(0).text(),porcentajeDescuento:parseInt(c.find("td").eq(1).text(),10),precioOfertado:parseFloat(c.find("td").eq(2).text()),fechaInicio:c.find("td").eq(3).text(),fechaFin:c.find("td").eq(4).text()};ne.push(f)});let _e=JSON.stringify(ne),oe=[];$("#listaColores tr").each(function(){let c=$(this),f={id:c.find("td").eq(0).text(),color:c.find("td").eq(1).text()};oe.push(f)});let Pe=JSON.stringify(oe),ie=[];$("#listaTalla tr").each(function(){let c=$(this),f={id:c.find("td").eq(0).text(),talla:parseInt(c.find("td").eq(1).text(),10)};ie.push(f)});let Oe=JSON.stringify(ie);var b=document.getElementById("imagenPrincipal"),h=b.src;let se=[];$("#listaImagenes tr").each(function(){let c=$(this),f={id:c.find("td").eq(0).text(),src:c.find("img").attr("src"),srcv:c.find("img").attr("src"),nombre:c.find("td").eq(2).text()};se.push(f)});let Se=JSON.stringify(se),re=[];$("#videoList tr").each(function(){let c=$(this),f={id:c.find("td").eq(0).text(),nombre:c.find("td").eq(1).text(),src:c.find("a").attr("href")};re.push(f)});let Ce=JSON.stringify(re),le=[];$("#videoList2 tr").each(function(){let c=$(this),f={id:c.find("td").eq(0).text(),nombre:c.find("td").eq(1).text(),src:c.find("a").attr("href")};le.push(f)});let Te=JSON.stringify(le);_.createAlertDialog("confirm","Confirmar Alerta","¿Estás seguro de que deseas guardar el producto?","Cancelar","Continuar",async()=>{try{ce();let f=await qe({productId:O,categoria_id:K,nombres_es:E,nombres_eng:I,resumen_es:g,resumen_eng:P,descripcion_es:N,descripcion_eng:e,cualidades_es:t,cualidades_eng:l,palabra_clave_es:u,palabra_clave_eng:a,numero_piezas_es:x,numero_piezas_eng:S,alto:d,ancho:m,materiales_es:ge,materiales_eng:he,precio:C,peso:T,tecnicas_es:$e,tecnicas_eng:ye,cantidad:B,cantidad_minima:L,restar_stock:Ee,tipo_estado:Z,fecha_disponible:M,imagen_principal:h,lst_otros_costos:xe,lst_ofertas:_e,lst_colores:Pe,lst_talla:Oe,lst_imagenes:Se,lst_videos:Ce,lst_videoenlace:Te,precios_envio:we,igv:Ie,precio_local:k,precio_nacional:F,precio_extranjero:D,tiempo_elaboracion:j,tiempo_envio:q,preventas:Ne,artesano_id:ee});if(f){if(p("Se actualizo los datos correctamente"),O==0){const de=new URL(window.location.href);de.searchParams.set("id",f.id),window.history.pushState({},"",de),O=f.id,Ke();var c=document.getElementById("tituloproducto");c.innerText="Editar producto",$("#btnguardarcambio").text("Actualizar")}W(),$("#myModal").css("display","none")}else p("Ocurrio un error.")}catch(f){console.error("Error al eliminar la foto de perfil:",f)}})}else{p("Por favor, ingresa todos los campos * requeridos.");return}});function s(){var r=document.getElementById("cantidad").value,v=document.getElementById("cantidadMinima").value,b=document.getElementById("error-message");if(r&&v){if(parseFloat(r)<parseFloat(v)){p("La cantidad minima no puede ser mayor."),document.getElementById("cantidadMinima").focus(),document.getElementById("cantidadMinima").value="";return}}else b.style.display="none"}document.getElementById("cantidad").addEventListener("input",s),document.getElementById("cantidadMinima").addEventListener("input",s)}const ue=document.getElementById("porcentajeDescuento"),U=document.getElementById("precioDisplay"),Ve=document.getElementById("precioOfertado");ue.addEventListener("input",function(){const o=parseFloat(ue.value),n=parseFloat(U.innerText)||parseFloat(U.textContent);if(isNaN(n)){p('Completar el precio actual, registrar en la pestaña "datos generales - Precio del producto".'),$("#porcentajeDescuento").val(""),$("#precioOfertado").val("");return}if(!isNaN(o)&&!isNaN(n)){const s=n*o/100,r=n-s;Ve.value=r.toFixed(2)}else{$("#porcentajeDescuento").val(""),$("#precioOfertado").val("");return}});const X=document.getElementById("fechaInicio"),G=document.getElementById("fechaFin");document.getElementById("errorMensaje");const Ue=new Date().toISOString().split("T")[0];G.value=Ue;function ve(){const o=new Date(X.value);new Date(G.value)<o&&(p("La fecha de fin no puede ser menor que la fecha de inicio."),G.value=X.value)}X.addEventListener("input",ve);G.addEventListener("input",ve);const me=document.getElementById("precioproducto"),be=document.getElementById("precioDisplay");me.addEventListener("input",function(){const o=me.value;be.textContent=o});async function Ge(o){i=await Je(o),$("#idespanolNombre").val(i.nombres_es),$("#idinglesNombre").val(i.nombres_eng),$("#idespanolResumen").val(i.resumen_es),$("#idinglesResumen").val(i.resumen_eng),$("#idespanolDescripcion").val(i.descripcion_es),$("#idinglesDescripcion").val(i.descripcion_eng),$("#idespanolCualidades").val(i.cualidades_es),$("#idinglesCualidades").val(i.cualidades_eng),$("#idespanolPalabras").val(i.palabra_clave_es),$("#idinglesPalabras").val(i.palabra_clave_eng),$("#idespanolPiezas").val(i.numero_piezas_es),$("#idinglesPiezas").val(i.numero_piezas_eng),$("#idalto").val(i.alto),$("#idancho").val(i.ancho),$("#idespanolMateriales").val(i.materiales_es),$("#idinglesMateriales").val(i.materiales_eng),$("#precioproducto").val(i.precio),be.textContent=i.precio,$("#pesokilogramos").val(i.peso),$("#idespanolTecnicas").val(i.tecnicas_es),$("#idinglesTecnicas").val(i.tecnicas_eng),$("#cantidad").val(i.cantidad),$("#cantidadMinima").val(i.cantidad_minima),i.restar_stock===1?document.getElementById("restarStock").checked=!0:document.getElementById("restarStock").checked=!1,$("#estadoAgotado").val(i.tipo_estado),$("#lstcategoria").val(i.categoria_id),$("#fechaDisponible").val(i.fecha_disponible),document.getElementById("imagenPrincipal").src=i.imagen_principal;const n=JSON.parse(i.lst_imagenes),s=JSON.parse(n);console.log("lst_imagenes:",s),s.forEach(d=>{w++;let m=`
                  <tr>
                      <td>${w}</td>
                      <td>
                          <div class="d-flex align-items-center">
                              <img src="${d.src}" alt="Imagen ${w}" class="img-thumbnail" style="width: 100px; height: 75px;">
                          </div>
                      </td>
                      <td>${d.nombre}</td>
                      <td>
                          <button type="button" data-toggle="tooltip" title="Eliminar" class="btn btn-primary btn-sm btn-delete-imagen">
                              <i class="icon icon-bin"></i>
                          </button>
                      </td>
                  </tr>
              `;document.getElementById("listaImagenes").insertAdjacentHTML("beforeend",m)});const r=JSON.parse(i.lst_videos);JSON.parse(r).forEach(d=>{R++;let m=`
              <tr>
                  <td>${R}</td>
                  <td>${d.nombre}</td>
                  <td><a href="${d.src}" target="_blank">Video subido</a></td>
                  <td>
                      <button type="button" class="btn btn-info btn-sm btn-view-video" data-link="${d.src}">Ver</button>  
                      <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-video">
                      <i class="icon icon-bin"></i> 
                  </td>
              </tr>
              `;document.getElementById("videoList").insertAdjacentHTML("beforeend",m)});const b=JSON.parse(i.lst_videoenlace);JSON.parse(b).forEach(d=>{V++;let m=` 
              <tr>
                  <td>${V}</td>
                  <td>${d.nombre}</td>
                  <td><a href="${d.src}" target="_blank">${d.src}</a></td>
                  <td>
                      <button type="button" class="btn btn-info btn-sm btn-view-video" data-link="${d.src}">Ver</button> 
                      
                      <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-video1">
                      <i class="icon icon-bin"></i> 
                  </td>
              </tr>
              `;document.getElementById("videoList2").insertAdjacentHTML("beforeend",m)});const E=JSON.parse(i.lst_colores);JSON.parse(E).forEach(d=>{J++;let m=`
              <tr>
                  <td>${J}</td>
                  <td>${d.color} <label id="color-label" style="background:${d.color} ; width: 10%;height: 25px;"></label></td> 
                  <td>
                      <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-colores">
                      <i class="icon icon-bin"></i>
                      </button> 

                  </td>
              </tr>
              `;document.getElementById("listaColores").insertAdjacentHTML("beforeend",m)});const g=JSON.parse(i.lst_talla);JSON.parse(g).forEach(d=>{A++;let m=`
              <tr>
                  <td>${A}</td>
                  <td>${d.talla}</td> 
                  <td>
                      <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-Talla">
                      <i class="icon icon-bin"></i>
                      </button> 

                  </td>
              </tr>
              `;document.getElementById("listaTalla").insertAdjacentHTML("beforeend",m)});const N=JSON.parse(i.lst_ofertas);JSON.parse(N).forEach(d=>{z++;let m=`
              <tr>
                  <td>${z}</td>
                  <td>${d.porcentajeDescuento}</td>
                  <td>${d.precioOfertado.toFixed(2)}</td>
                  <td>${d.fechaInicio}</td>
                  <td>${d.fechaFin}</td>
                  <td>
                      <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm  btn-delete-offer">
                      <i class="icon icon-bin"></i>
                      </button>
                  </td>
              </tr>
              `;document.getElementById("listaOfertas").insertAdjacentHTML("beforeend",m)});const t=JSON.parse(i.lst_otros_costos);JSON.parse(t).forEach(d=>{H++;let m=`
              <tr>
                  <td>${H}</td>
                  <td>${d.nombre}</td>
                  <td>${d.precio}</td>
                  <td>
                      <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-cost">
                      <i class="icon icon-bin"></i>
                      </button> 
    
                  </td>
              </tr>
              `;document.getElementById("listaCostos").insertAdjacentHTML("beforeend",m)});var u=document.getElementById("envioLocal"),a=document.getElementById("envioNacional"),x=document.getElementById("envioExtranjero");i.precios_envio===1?(document.getElementById("precioEnvio").checked=!0,u.disabled=!1,a.disabled=!1,x.disabled=!1,$("#envioLocal").val(i.precio_local),$("#envioNacional").val(i.precio_nacional),$("#envioExtranjero").val(i.precio_extranjero)):(document.getElementById("precioEnvio").checked=!1,u.disabled=!0,a.disabled=!0,x.disabled=!0),i.igv===1?document.getElementById("impuestoIGV").checked=!0:document.getElementById("impuestoIGV").checked=!1,$("#tiemposElaboracion").val(i.tiempo_elaboracion),$("#tiemposEnvio").val(i.tiempo_envio),i.preventas===1?document.getElementById("preventas").checked=!0:document.getElementById("preventas").checked=!1,ee=i.artesano_id;const S=await He(i.artesano_id);$("#dni").val(S.dni),$("#nombrecompleto").val(S.nombres+" "+S.apellidos)}function Ze(){$("#home-tab2, #home-tab3, #home-tab4, #home-tab5, #home-tab6, #home-tab7, #home-tab8").addClass("disabled")}function Ke(){document.getElementById("home-tab2").classList.remove("disabled"),document.getElementById("home-tab3").classList.remove("disabled"),document.getElementById("home-tab4").classList.remove("disabled"),document.getElementById("home-tab5").classList.remove("disabled"),document.getElementById("home-tab6").classList.remove("disabled"),document.getElementById("home-tab7").classList.remove("disabled"),document.getElementById("home-tab8").classList.remove("disabled")}$(document).ready(function(){et(),O=new URLSearchParams(window.location.search).get("id");var n=document.getElementById("tituloproducto");O!=0?(Ge(O),n.innerText="Editar producto",$("#btnguardarcambio").text("Actualizar")):(Ze(),n.innerText="Nuevo producto");const s=document.getElementById("idespanolNombre");s.addEventListener("input",async function(){const e=s.value.trim(),t=new Headers;t.append("Content-Type","application/json");const l=JSON.stringify({text:e});fetch("https://dni.biblio-ideas.com/api/translate",{method:"POST",headers:t,body:l,redirect:"follow"}).then(a=>a.json()).then(a=>{$("#idinglesNombre").val(a.translatedText)}).catch(a=>console.error("Error:",a))}),$("#ingles-tab").on("shown.bs.tab",function(e){if($("#idespanolNombre").val()===""){$("#idinglesNombre").val(""),p("Por favor, ingrese un nombre de producto en español antes de traducir.");return}});const r=document.getElementById("idespanolResumen");r.addEventListener("input",async function(){const e=r.value.trim(),t=new Headers;t.append("Content-Type","application/json");const l=JSON.stringify({text:e});fetch("https://dni.biblio-ideas.com/api/translate",{method:"POST",headers:t,body:l,redirect:"follow"}).then(a=>a.json()).then(a=>{$("#idinglesResumen").val(a.translatedText)}).catch(a=>console.error("Error:",a))}),$("#ingles-tab-resumen").on("shown.bs.tab",function(e){if($("#idespanolResumen").val()===""){$("#idinglesResumen").val(""),p("Por favor, ingrese el resumen de producto en español antes de traducir.");return}});const v=document.getElementById("idespanolDescripcion");v.addEventListener("input",async function(){const e=v.value.trim(),t=new Headers;t.append("Content-Type","application/json");const l=JSON.stringify({text:e});fetch("https://dni.biblio-ideas.com/api/translate",{method:"POST",headers:t,body:l,redirect:"follow"}).then(a=>a.json()).then(a=>{$("#idinglesDescripcion").val(a.translatedText)}).catch(a=>console.error("Error:",a))}),$("#ingles-tab-descripcion").on("shown.bs.tab",function(e){if($("#idespanolDescripcion").val()===""){$("#idinglesDescripcion").val(""),p("Por favor, ingrese la descripción del producto en español antes de traducir.");return}});const b=document.getElementById("idespanolCualidades");b.addEventListener("input",async function(){const e=b.value.trim(),t=new Headers;t.append("Content-Type","application/json");const l=JSON.stringify({text:e});fetch("https://dni.biblio-ideas.com/api/translate",{method:"POST",headers:t,body:l,redirect:"follow"}).then(a=>a.json()).then(a=>{$("#idinglesCualidades").val(a.translatedText)}).catch(a=>console.error("Error:",a))}),$("#ingles-tab-cualidades").on("shown.bs.tab",function(e){if($("#idespanolCualidades").val()===""){$("#idinglesCualidades").val(""),p("Por favor, ingrese las cualidades del producto en español antes de traducir.");return}});const h=document.getElementById("idespanolPalabras");h.addEventListener("input",async function(){const e=h.value.trim(),t=new Headers;t.append("Content-Type","application/json");const l=JSON.stringify({text:e});fetch("https://dni.biblio-ideas.com/api/translate",{method:"POST",headers:t,body:l,redirect:"follow"}).then(a=>a.json()).then(a=>{$("#idinglesPalabras").val(a.translatedText)}).catch(a=>console.error("Error:",a))}),$("#ingles-tab-palabras").on("shown.bs.tab",function(e){if($("#idespanolPalabras").val()===""){$("#idinglesPalabras").val(""),p("Por favor, ingrese palabra clave del producto en español antes de traducir.");return}});const E=document.getElementById("idespanolPiezas");E.addEventListener("input",async function(){const e=E.value.trim(),t=new Headers;t.append("Content-Type","application/json");const l=JSON.stringify({text:e});fetch("https://dni.biblio-ideas.com/api/translate",{method:"POST",headers:t,body:l,redirect:"follow"}).then(a=>a.json()).then(a=>{$("#idinglesPiezas").val(a.translatedText)}).catch(a=>console.error("Error:",a))}),$("#ingles-tab-piezas").on("shown.bs.tab",function(e){if($("#idespanolPiezas").val()===""){$("#idinglesPiezas").val(""),p("Por favor, ingrese numero de piezas del producto en español antes de traducir.");return}});const I=document.getElementById("idespanolMateriales");I.addEventListener("input",async function(){const e=I.value.trim(),t=new Headers;t.append("Content-Type","application/json");const l=JSON.stringify({text:e});fetch("https://dni.biblio-ideas.com/api/translate",{method:"POST",headers:t,body:l,redirect:"follow"}).then(a=>a.json()).then(a=>{$("#idinglesMateriales").val(a.translatedText)}).catch(a=>console.error("Error:",a))}),$("#ingles-tab-materiales").on("shown.bs.tab",function(e){if($("#idespanolMateriales").val()===""){$("#idinglesMateriales").val(""),p("Por favor, ingrese descripción de materiales del producto en español antes de traducir.");return}});const g=document.getElementById("idespanolTecnicas");g.addEventListener("input",async function(){const e=g.value.trim(),t=new Headers;t.append("Content-Type","application/json");const l=JSON.stringify({text:e});fetch("https://dni.biblio-ideas.com/api/translate",{method:"POST",headers:t,body:l,redirect:"follow"}).then(a=>a.json()).then(a=>{$("#idinglesTecnicas").val(a.translatedText)}).catch(a=>console.error("Error:",a))}),$("#ingles-tab-tecnicas").on("shown.bs.tab",function(e){if($("#idespanolTecnicas").val()===""){$("#idinglesTecnicas").val(""),p("Por favor, ingrese técnicas empleadas del producto en español antes de traducir.");return}}),$("#addCostoButton").on("click",function(){let e=$("#nombreCosto").val(),t=$("#precioCosto").val();if(e===""||t===""){p("Por favor, complete todos los campos *.");return}H++;let l=`
          <tr>
              <td>${H}</td>
              <td>${e}</td>
              <td>${t}</td>
              <td>
                  <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-cost">
                  <i class="icon icon-bin"></i>
                  </button> 

              </td>
          </tr>
      `;$("#listaCostos").append(l),$("#nombreCosto").val(""),$("#precioCosto").val("")}),$(document).on("click",".btn-delete-cost",function(){_.createAlertDialog("confirm","Confirmar Alerta","¿Estás seguro de que deseas eliminar?","Cancelar","Continuar",async()=>{try{$(this).closest("tr").remove(),H--,$("#listaCostos tr").each(function(e,t){$(t).find("td:first").text(e+1)})}catch(e){console.error("Error al eliminar:",e)}})});function P(e){return/^\d+$/.test(e)}function N(e){return/^\d+(\.\d+)?$/.test(e)}$("#addOfferButton").on("click",function(){let e=$("#porcentajeDescuento").val(),t=$("#precioOfertado").val(),l=$("#fechaInicio").val(),u=$("#fechaFin").val();const a=parseFloat(U.innerText)||parseFloat(U.textContent);if(isNaN(a)){p('Completar el precio actual, registrar en la pestaña "datos generales - Precio del producto".'),$("#porcentajeDescuento").val(""),$("#precioOfertado").val("");return}if(e===""||t===""||l===""||u===""){p("Por favor, complete todos los campos *.");return}if(e=e===""?0:P(e)?parseInt(e,10):NaN,t=t===""?0:N(t)?parseFloat(t):NaN,isNaN(e)||isNaN(t)){p("Por favor, ingrese valores válidos.");return}z++;let x=`
          <tr>
              <td>${z}</td>
              <td>${e}</td>
              <td>${t.toFixed(2)}</td>
              <td>${l}</td>
              <td>${u}</td>
              <td>
                  <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm  btn-delete-offer">
                  <i class="icon icon-bin"></i>
                  </button>
              </td>
          </tr>
      `;$("#listaOfertas").append(x),$("#porcentajeDescuento").val(""),$("#precioOfertado").val(""),$("#fechaInicio").val(""),$("#fechaFin").val("")}),$(document).on("click",".btn-delete-offer",function(){_.createAlertDialog("confirm","Confirmar Alerta","¿Estás seguro de que deseas eliminar?","Cancelar","Continuar",async()=>{try{$(this).closest("tr").remove(),z--,$("#listaOfertas tr").each(function(e,t){$(t).find("td:first").text(e+1)})}catch(e){console.error("Error al eliminar:",e)}})}),$("#addcolorbtn").on("click",function(){let e=$("#color-input").val();if(e===""){p("Por favor, complete todos los campos *.");return}J++;let t=`
          <tr>
              <td>${J}</td> 
              <td>${e} <label  style="background: ${e};width: 10%; height: 25px;"></label></td> 
              <td>
                  <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-colores">
                  <i class="icon icon-bin"></i>
                  </button> 

              </td>
          </tr>
      `;$("#listaColores").append(t),$("#color-input").val("")}),$(document).on("click",".btn-delete-colores",function(){_.createAlertDialog("confirm","Confirmar Alerta","¿Estás seguro de que deseas eliminar?","Cancelar","Continuar",async()=>{try{$(this).closest("tr").remove(),J--,$("#listaColores tr").each(function(e,t){$(t).find("td:first").text(e+1)})}catch(e){console.error("Error al eliminar:",e)}})}),$("#addtallabtn").on("click",function(){let e=$("#talla-input").val();if(e===""){p("Por favor, complete todos los campos *.");return}A++;let t=`
          <tr>
              <td>${A}</td>
              <td>${e}</td> 
              <td>
                  <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-Talla">
                  <i class="icon icon-bin"></i>
                  </button> 

              </td>
          </tr>
      `;$("#listaTalla").append(t),$("#talla-input").val("")}),$(document).on("click",".btn-delete-Talla",function(){_.createAlertDialog("confirm","Confirmar Alerta","¿Estás seguro de que deseas eliminar?","Cancelar","Continuar",async()=>{try{$(this).closest("tr").remove(),A--,$("#listaTalla tr").each(function(e,t){$(t).find("td:first").text(e+1)})}catch(e){console.error("Error al eliminar:",e)}})}),$("#guardarBtn").on("click",function(){let e=$("#imageName").val(),t=$("#imagePreview").attr("src");if(!e||!t){p("Por favor, suba una imagen.");return}w++;let l=`
                    <tr>
                        <td>${w}</td>
                        <td>
                            <div class="d-flex align-items-center">
                                <img src="${t}" alt="Imagen ${w}" class="img-thumbnail" style="width: 100px; height: 75px;"> 
                            </div>
                        </td>
                        <td>${e}</td>
                        <td>
                        <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-imagen">
                          <i class="icon icon-bin"></i> 
                    </tr>
                `;$("#listaImagenes").append(l),$("#imagenModal").modal("hide"),$("#imagenForm")[0].reset(),$("#imagePreview").hide()}),$(document).on("click",".btn-delete-imagen",function(){_.createAlertDialog("confirm","Confirmar Alerta","¿Estás seguro de que deseas eliminar?","Cancelar","Continuar",async()=>{try{$(this).closest("tr").remove(),w--,$("#listaImagenes tr").each(function(e,t){$(t).find("td:first").text(e+1)})}catch(e){console.error("Error al eliminar:",e)}})}),$("#guardarPrincipalBtn").on("click",function(){let e=$("#principalImagePreview").attr("src"),t=$("#principalImageName").val();if($("#imageName").val(),$("#imagePreview").attr("src"),!e||!t){p("Por favor, suba una imagen.");return}$("#imagenPrincipal").attr("src",e),$("#imagenPrincipalModal").modal("hide"),$("#imagenPrincipalForm")[0].reset(),$("#principalImagePreview").hide()}),$("#limpiarPrincipalBtn").on("click",function(){$("#imagenPrincipal").attr("src","/img/sin_imagen.jpg")}),$("#addVideoLink").on("click",function(){let e=$("#linkVideoName").val(),t=$("#videoLink").val();if(!e||!t){p("Por favor, complete todos los campos *.");return}var l=document.getElementById("videoLink").value;document.getElementById("message");var u=new RegExp("^(https?:\\/\\/)?((([a-zA-Z0-9]{1,}\\.)?[a-zA-Z0-9]{2,}\\.[a-zA-Z]{2,})|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-zA-Z0-9@:%_\\+.~#?&//=]*)?(\\?[;&a-zA-Z0-9@:%_\\+.~#?&//=]*)?(\\#[-a-zA-Z0-9@:%_\\+.~#?&//=]*)?$","i");if(!u.test(l)){p("URL no válida."),$("#videoLink").val("");return}V++;let a=`
          <tr>
              <td>${V}</td>
              <td>${e}</td>
              <td><a href="${t}" target="_blank">${t}</a></td>
              <td>
                  <button type="button" class="btn btn-info btn-sm btn-view-video" data-link="${t}">Ver</button> 
                  
                  <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-video1">
                  <i class="icon icon-bin"></i> 
              </td>
          </tr>
      `;$("#videoList2").append(a),$("#linkForm")[0].reset()}),$(document).on("click",".btn-delete-video1",function(){_.createAlertDialog("confirm","Confirmar Alerta","¿Estás seguro de que deseas eliminar?","Cancelar","Continuar",async()=>{try{$(this).closest("tr").remove(),w--,$("#videoList2 tr").each(function(e,t){$(t).find("td:first").text(e+1)})}catch(e){console.error("Error al eliminar:",e)}})}),$(document).on("click",".btn-view-video",function(){let e=$(this).data("link"),t=e;e.includes("youtube.com/watch")?t=`https://www.youtube.com/embed/${new URLSearchParams(new URL(e).search).get("v")}`:e.includes("youtu.be")&&(t=`https://www.youtube.com/embed/${e.split("/").pop()}`),$("#videoPlayer").attr("src",t),$("#videoModal").modal("show")}),$("#videoModal").on("hidden.bs.modal",function(){$("#videoPlayer").attr("src","")}),$("#uploadVideo").on("change",function(){let e=$(this).prop("files")[0];if(e){let t=(e.size/1048576).toFixed(2);if($("#fileSize").text(`${t}mb`),e.size>100*1024*1024)$("#uploadProgress").addClass("bg-danger").text("100%"),$("#uploadProgress").css("width","100%");else{let l=(e.size/104857600*100).toFixed(0);$("#uploadProgress").removeClass("bg-danger").addClass("bg-success").text(`${l}%`),$("#uploadProgress").css("width",`${l}%`)}}else $("#fileSize").text("100mb"),$("#uploadProgress").removeClass("bg-danger bg-success").text("0%"),$("#uploadProgress").css("width","0%")}),$("#cancelUpload").on("click",function(){$("#uploadVideo").val(""),$("#fileSize").text("100mb"),$("#uploadProgress").removeClass("bg-danger bg-success").text("0%"),$("#uploadProgress").css("width","0%")}),$("#registerVideo").on("click",function(){let e=$("#videoName").val(),t=$("#uploadVideo").prop("files")[0];if(!e||!t){p("Por favor, complete todos los campos *.");return}if(t.size>100*1024*1024){p("El archivo no debe pesar más de 100mb.");return}R++;var l=document.getElementById("videoPreview"),u=l.src;let a=u,x=`
          <tr>
              <td>${R}</td>
              <td>${e}</td>
              <td><a href="${a}" target="_blank">Video subido</a></td>
              <td>
                  <button type="button" class="btn btn-info btn-sm btn-view-video" data-link="${a}">Ver</button>  
                  <button type="button" data-toggle="tooltip"  title="Eliminar" class="btn btn-primary btn-sm btn-delete-video">
                  <i class="icon icon-bin"></i> 
              </td>
          </tr>
      `;$("#videoList").append(x),$("#videoForm")[0].reset(),$("#fileSize").text("100mb"),$("#uploadProgress").removeClass("bg-danger bg-success").text("0%"),$("#uploadProgress").css("width","0%")}),$(document).on("click",".btn-delete-video",function(){_.createAlertDialog("confirm","Confirmar Alerta","¿Estás seguro de que deseas eliminar?","Cancelar","Continuar",async()=>{try{$(this).closest("tr").remove(),w--,$("#videoList tr").each(function(e,t){$(t).find("td:first").text(e+1)})}catch(e){console.error("Error al eliminar:",e)}})})});document.addEventListener("DOMContentLoaded",()=>{te({fileInputId:"uploadPrincipalImage",progressBarId:"progressBar",statusElementId:"status",uploadUrl:y+"/producto/fileupload",callback:Qe,folder:"/producto/img/"})});function Qe(o){let n=$("#uploadPrincipalImage").prop("files")[0];if(n){let s=new FileReader;s.onload=function(r){$("#principalImagePreview").attr("src",Y(y)+"/"+o.path).show(),$("#principalImageName").val(n.name)},s.readAsDataURL(n)}else p("Por favor, seleccione un archivo para visualizar.")}document.addEventListener("DOMContentLoaded",()=>{te({fileInputId:"uploadImage",progressBarId:"progressBar",statusElementId:"status",uploadUrl:y+"/producto/fileupload",callback:We,folder:"/producto/img/"})});function We(o){let n=$("#uploadImage").prop("files")[0];if(n){let s=new FileReader;s.onload=function(r){$("#imagePreview").attr("src",Y(y)+"/"+o.path).show(),$("#imageName").val(n.name)},s.readAsDataURL(n)}else p("Por favor, seleccione un archivo para visualizar.")}document.addEventListener("DOMContentLoaded",()=>{te({fileInputId:"uploadVideo",progressBarId:"progressBar",statusElementId:"status",uploadUrl:y+"/producto/fileupload",callback:Xe,folder:"/producto/video/"})});function Xe(o){$("#videoPreview").attr("src",Y(y)+"/"+o.path).show()}function te({fileInputId:o,progressBarId:n,statusElementId:s,uploadUrl:r,folder:v,callback:b}){const h=document.getElementById(o),E=h.name,I=document.getElementById(n),g=document.getElementById(s);h&&I&&g?new ke(r,I,g,b,E,v).attachToFileInput(h):console.error("Initialization failed: One or more elements not found.")}const fe=document.getElementById("dni"),Ye=document.getElementById("nombrecompleto");fe.addEventListener("input",async function(){const o=fe.value.trim();if(o.length==8){const s=await ze(o);s!=null?(Ye.value=s.nombres+" "+s.apellidos,ee=s.id):(p("No existe registro de artesano"),$("#nombrecompleto").val(""))}});document.getElementById("precioEnvio").addEventListener("change",function(){var o=this,n=document.getElementById("envioLocal"),s=document.getElementById("envioNacional"),r=document.getElementById("envioExtranjero");n.disabled=!o.checked,s.disabled=!o.checked,r.disabled=!o.checked,$("#envioLocal").val(""),$("#envioNacional").val(""),$("#envioExtranjero").val("")});const Q=document.getElementById("lstcategoria");async function et(){try{const o=await Ae();Q.innerHTML="";let n=document.createElement("option");n.value="0",n.textContent="Seleccionar",Q.appendChild(n),o.forEach(s=>{let r=document.createElement("option");r.value=s.id,r.textContent=s.abreviatura,Q.appendChild(r)})}catch(o){console.error("Error al llenar el select:",o)}}
