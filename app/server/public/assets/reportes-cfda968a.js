import{b as n,h as i,l as c,c as l,g as p}from"./init-35cba5cd.js";import{l as u,_ as d}from"./viewpartials-7a86f681.js";async function h(s){try{const t={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(n+"/api/reporteusuariosiestp?iestpid="+s,t)).json()}catch(e){console.log("error",e)}}async function f(s){try{const t={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(n+"/api/reportelibrosiestp?iestpid="+s,t)).json()}catch(e){console.log("error",e)}}async function m(s,e,t){try{const a={method:"GET",headers:new Headers,redirect:"follow"};return await(await fetch(n+`/api/reporteaccesosiestp?iestpid=${s}&fechini=${e}&fechfin=${t}`,a)).json()}catch(r){console.log("error",r)}}i();(async function(){let s=[{path:"partials/shared/header.html",container:"app-header"},{path:"partials/shared/menuadmin.html",container:"app-side"}];try{await u(s),d(()=>import("./common-8d3221b9.js"),[]),console.log("Las vistas parciales se han cargado correctamente!"),y()}catch(e){console.error(e)}})();function y(){w(),c(),g()}async function w(){(await l()).usuario.rolid!=1&&(location.href="sinacceso.html")}async function g(){let s=p("session").usuario;$("#btndescargarusuarios").on("click",async function(e){e.preventDefault();let t=await h(s.iestpid);o(t,"ReporteUsuarios")}),$("#btndescargarlibros").on("click",async function(e){e.preventDefault();let t=await f(s.iestpid);o(t,"ReporteLibros")}),$("#btndescargaraccesos").on("click",async function(e){e.preventDefault();let t=await m(s.iestpid,$("#txt_fechini").val(),$("#txt_fechfin").val());o(t,"ReporteAccesos")})}function o(s,e){var t=alasql(`SELECT *
  FROM ? `,[s]),r=[{sheetid:"Reporte",headers:!0}];alasql(`SELECT INTO XLSX("${e}.xlsx",?) FROM ?`,[r,[t]])}
