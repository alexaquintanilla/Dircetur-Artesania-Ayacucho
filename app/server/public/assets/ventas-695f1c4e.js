import"./modulepreload-polyfill-3cfb730f.js";import{_ as T}from"./preload-helper-101896b7.js";import{b as I}from"./config-d2c69cb0.js";import{l as A}from"./viewpartials-ac66bf27.js";import{h as M,l as D}from"./init-b7ef0f37.js";async function F(e,t){try{return await(await fetch(`${I}/pedido?page=${e}&limit=${t}`)).json()}catch(l){throw console.error("Error al encontrar las categorías:",l),l}}async function P(e){try{const t=new URLSearchParams(e);return await(await fetch(`${I}/pedidos?${t}`)).json()}catch(t){throw console.error("Error al buscar las categorias:",t),t}}M();(async function(){let e=[{path:"partials/shared/header.html",container:"app-header"},{path:"partials/shared/menu.html",container:"app-side"}];try{await A(e),T(()=>import("./common-8d3221b9.js"),[]),console.log("Las vistas parciales se han cargado correctamente!"),U()}catch(t){console.error(t)}})();function U(){setTimeout(function(){D()},500)}const f=10;let a=1,_=0,y={};const S=document.getElementById("filtrar-pedido"),H=document.getElementById("tablaPedidos"),N=H.getElementsByTagName("tbody")[0];async function w(){try{let e;if(Object.keys(y).length===0)e=await F(a,f);else{const t={...y,page:a,limit:f};e=await P(t)}x(e.pedidos),_=Math.ceil(e.totalItems/f),B(_,e.totalItems)}catch(e){console.error("Error:",e)}}function B(e,t){const l=(a-1)*f+1;let n=a*f;n>t&&(n=t);const b=document.getElementById("paginationInfo");b.innerHTML=`Viendo del ${l} al ${n} de un total de ${t} resultados`;const i=document.getElementById("paginationControls");i.innerHTML="";const d=document.createElement("li");d.className="paginate_button page-item previous",d.id="apiCallbacks_previous",a===1&&d.classList.add("disabled");const g=document.createElement("a");g.className="page-link",g.href="#",g.textContent="Anterior",g.addEventListener("click",()=>E(a-1)),d.appendChild(g),i.appendChild(d);const h=3;if(e<=h)for(let c=1;c<=e;c++){const r=document.createElement("li");r.className="paginate_button page-item",c===a&&r.classList.add("active");const u=document.createElement("a");u.className="page-link",u.href="#",u.textContent=c,u.addEventListener("click",()=>E(c)),r.appendChild(u),i.appendChild(r)}else{const c=document.createElement("li");c.className="paginate_button page-item",a===1&&c.classList.add("active");const r=document.createElement("a");if(r.className="page-link",r.href="#",r.textContent=1,r.addEventListener("click",()=>E(1)),c.appendChild(r),i.appendChild(c),a>Math.floor(h/2)+1){const s=document.createElement("li");s.className="paginate_button page-item disabled",s.id="apiCallbacks_ellipsis";const o=document.createElement("a");o.className="page-link",o.href="#",o.textContent="…",s.appendChild(o),i.appendChild(s)}let u=Math.max(a-Math.floor(h/2),2),v=Math.min(u+h-1,e-1);for(let s=u;s<=v;s++){const o=document.createElement("li");o.className="paginate_button page-item",s===a&&o.classList.add("active");const k=document.createElement("a");k.className="page-link",k.href="#",k.textContent=s,k.addEventListener("click",()=>E(s)),o.appendChild(k),i.appendChild(o)}if(v<e-1){const s=document.createElement("li");s.className="paginate_button page-item disabled",s.id="apiCallbacks_ellipsis";const o=document.createElement("a");o.className="page-link",o.href="#",o.textContent="…",s.appendChild(o),i.appendChild(s)}const L=document.createElement("li");L.className="paginate_button page-item",a===e&&L.classList.add("active");const C=document.createElement("a");C.className="page-link",C.href="#",C.textContent=e,C.addEventListener("click",()=>E(e)),L.appendChild(C),i.appendChild(L)}const p=document.createElement("li");p.className="paginate_button page-item next",p.id="apiCallbacks_next",a===e&&p.classList.add("disabled");const m=document.createElement("a");m.className="page-link",m.href="#",m.textContent="Siguiente",m.addEventListener("click",()=>E(a+1)),p.appendChild(m),i.appendChild(p)}async function E(e){e!==a&&(a=e,await w())}S.addEventListener("click",async e=>{e.preventDefault(),await j()});async function j(){const e=document.getElementById("num-pedido").value,t=document.getElementById("nombre-artesano").value,l=document.getElementById("nombre-cliente").value,n=document.getElementById("fecha-pedido").value,b=document.getElementById("estado").value;y={num_pedido:e,nombre_artesano:t,nombre_cliente:l,fecha_pedido:n,estado:b},a=1;try{const i={...y,page:a,limit:f},d=await P(i);x(d.pedidos),_=Math.ceil(d.totalItems/f),B(_,d.totalItems)}catch(i){console.error("Error al filtrar pedidos:",i)}}function x(e){N.innerHTML="",e.forEach(t=>{var h,p,m,c;const l=document.createElement("tr");let n="";switch(t.estado){case"pendiente":n="badge badge-pill badge-warning text-white";break;case"pagado":n="badge badge-pill badge-success";break;case"envio":n="badge badge-pill badge-info";break;case"finalizado":n="badge badge-pill badge-primary";break;case"anulado":n="badge badge-pill badge-danger";break;default:n=""}const b=((h=t.cliente)==null?void 0:h.nombres)??"NA",i=((p=t.cliente)==null?void 0:p.apellidos)??"NA",d=((m=t.artesano)==null?void 0:m.nombres)??"NA",g=((c=t.artesano)==null?void 0:c.apellidos)??"NA";l.innerHTML=`
            <td>${t.num_pedido}</td>
            <td>${b} ${i}</td>
            <td>${d} ${g}</td>
            <td>${$(t.fecha_pedido)}</td>
            <td>${$(t.updatedAt)}</td>
            <td><span class="${n}">${t.estado}</span></td>
            <td>
                <button type="button" class="btn btn-light btn-sm">
                    <a href="/ventas-detalle.html?id=${t.num_pedido}">
                        <i class="icon icon-eye2"></i>
                    </a>
                </button>
            </td>
        `,N.appendChild(l)})}function $(e){const t=new Date(e),l=t.getUTCFullYear(),n=("0"+(t.getUTCMonth()+1)).slice(-2);return`${("0"+t.getUTCDate()).slice(-2)}/${n}/${l}`}document.addEventListener("DOMContentLoaded",()=>{w()});
